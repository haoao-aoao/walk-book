<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.neusoft.demo.goodsMessage.dao.GoodsMessageDao">

    <!--<resultMap id="GoodsSortMap" type="com.neusoft.demo.goodsSort.entity.GoodsSort">-->
        <!--<id property="cateCode" column="gcateCode"></id>-->
        <!--<result property="cateName" column="gcateName"></result>-->
        <!--<result property="level" column="glevel"></result>-->
        <!--<result property="isDelete" column="gDelete"></result>-->
        <!--&lt;!&ndash;配置集合的映射&ndash;&gt;-->
        <!--<collection property="goodsClassifyTwo" javaType="list" ofType="com.neusoft.demo.goodsSort.entity.GoodsSort">-->
            <!--<id property="cateCode" column="goodsClassifyTwoCode"></id>-->
            <!--<result property="cateName" column="goodsClassifyTwoName"></result>-->
            <!--<result property="level" column="plevel"></result>-->
            <!--<result property="cateCodeParent" column="cateCodeParent"></result>-->
            <!--<result property="isDelete" column="pDelete"></result>-->
        <!--</collection>-->
    <!--</resultMap>-->

    <!--新增商品-->
    <insert id="addGoods" parameterType="com.neusoft.demo.goodsMessage.entity.GoodsMessage">
        insert into t_goods_message
        (goods_code,
         goods_name,
         classify_one_Code,
         classify_two_Code,
         goods_pricing,
         goods_price,
         goods_stock,
         goods_no,
         goods_state,
         goods_sketch,
         goods_author,
         goods_press,
         goods_img_code,
         sales_volume,
         goods_view,
         goods_star,
         vendor_name,
         up_time,
         is_delete,
         create_time,
         create_user,
         gmt_modfied,
         last_modfied_by,
         version)
        values
            (#{goodsCode},
             #{goodsName},
             #{classifyOneCode},
             #{classifyTwoCode},
             #{goodsPricing},
             #{goodsPrice},
             #{goodsStock},
             #{goodsNo},
             2,
             #{goodsSketch},
             #{goodsAuthor},
             #{goodsPress},
             #{goodsImgCode},
             #{salesVolume},
             #{goodsView},
             #{goodsStar},
             #{vendorName},
             now(),
             0,
             now(),
             #{createUser},
             now(),
             #{lastModfiedBy},
             0)
    </insert>

    <!--查询商品信息列表-->
    <select id="listGoods" parameterType="com.neusoft.demo.goodsMessage.entity.GoodsMessage" resultType="com.neusoft.demo.goodsMessage.entity.GoodsMessage">
        select
            goods_code          goodsCode,
            goods_name          goodsName,
            classify_one_Code   classifyOneCode,
            classify_two_Code   classifyTwoCode,
            goods_pricing       goodsPricing,
            goods_price         goodsPrice,
            sales_volume        salesVolume,
            goods_stock         goodsStock,
            goods_no            goodsNo,
            goods_sketch        goodsSketch,
            goods_state         goodsState,
            goods_author        goodsAuthor,
            goods_press         goodsPress,
            goods_img_code      goodsImgCode,
            vendor_name         vendorName,
            goods_view          goodsView,
            goods_star          goodsStar,
            vendor_name         vendorName,
            up_time             upTime,
            version
        from t_goods_message
        where is_delete = 0
        <if test="goodsName != null and goodsName != ''">
            and goods_name like concat('%', #{goodsName}, '%')
        </if>
        <if test="goodsState != null and goodsState != ''">
            and goods_state like concat('%', #{goodsState}, '%')
        </if>
        <if test="goodsAuthor != null and goodsAuthor != ''">
            and goods_author like concat('%', #{goodsAuthor}, '%')
        </if>
        <if test="goodsPress != null and goodsPress != ''">
            and goods_press like concat('%', #{goodsPress}, '%')
        </if>
        order by create_time desc
    </select>

    <!--修改商品信息-->
    <update id="updateGoodsById" parameterType="com.neusoft.demo.goodsMessage.entity.GoodsMessage">
        update t_goods_message
        set
            goods_name        =  #{goodsName},
            classify_one_Code =  #{classifyOneCode},
            classify_two_Code =  #{classifyTwoCode},
            goods_pricing     =  #{goodsPricing},
            goods_price       =  #{goodsPrice},
            goods_stock       =  #{goodsStock},
            goods_no          =  #{goodsNo},
            goods_sketch      =  #{goodsSketch},
            goods_author      =  #{goodsAuthor},
            goods_press       =  #{goodsPress},
            gmt_modfied =        now(),
            last_modfied_by   =  #{lastModfiedBy},
            version      =       version + 1
        where
            goods_code = #{goodsCode}
            and version = #{version}
    </update>

    <!--查询商品信息详情-->
    <select id="findGoodsById" parameterType="java.lang.String" resultType="com.neusoft.demo.goodsMessage.entity.GoodsMessage">
        select
            goods_name          goodsName,
            classify_one_Code   classifyOneCode,
            classify_two_Code   classifyTwoCode,
            goods_pricing       goodsPricing,
            goods_price         goodsPrice,
            goods_stock         goodsStock,
            goods_no            goodsNo,
            goods_sketch        goodsSketch,
            goods_author        goodsAuthor,
            goods_press         goodsPress,
            goods_img_code      goodsImgCode,
            vendor_name         vendorName,
            version
        from t_goods_message
        where goods_code = #{goodsCode}
        and is_delete = 0
    </select>

    <!--删除商品信息-->
    <update id="deleteGoods" parameterType="com.neusoft.demo.goodsMessage.entity.GoodsMessage">
        update t_goods_message
        set
        is_delete = 1,
        gmt_modfied = now(),
        last_modfied_by = #{userCode},
        version = version + 1
        where goods_code in
        <foreach item="item" index="index" collection="listCode" open="(" separator="," close=")">
            #{item}
        </foreach>
    </update>

    <!--修改商品状态-->
    <update id="updateGoodsState" parameterType="com.neusoft.demo.goodsMessage.entity.GoodsMessage">
        update t_goods_message
        set
        gmt_modfied = now(),
        last_modfied_by = #{lastModfiedBy},
        goods_state = #{goodsState},
        version = version + 1
        where goods_code in
        <foreach item="item" index="index" collection="listCode" open="(" separator="," close=")">
            #{item}
        </foreach>
    </update>
</mapper>